# Kospi200ConsumerDiscretionary
VAR, VARMAX, LSTM모델을 이용한 "코스피200 경기 소비재 지수" 에측모델


[프레젠테이션](https://drive.google.com/file/d/1RFAu1CvGGJKqtE9PIcIgL-yvme_rfin5/view?usp=drive_link)

## 개요

 한창 비트코인이나 주식 리딩방, 혹은 부티크 사기가 성행 중임. 그래서 불확실한 리딩방에 현혹되지 않고 수치적으로 참고할 수 있는 인덱스를 하나 만들어서 그런 사기피해를 줄일 수 있기를 바라며 국내 소비재 지수를 예측하는 단기 인덱스를 만들게 되었음

  

## 데이터

 이 프로젝트에서 데이터의 종류가 많고, 모델에 입력할 때 부적절한 데이터가 많다는 문제에 직면. 이 문제를 해결하기 위해 여러 단계의 피처 선택(feature selection) 과정을 거쳤음.

1. 다중공선성 제거: 먼저, 변수들 간의 상관관계를 파악하여 다중공선성 문제를 해결하기 위해 피어슨 상관계수와 VIF(분산팽창요인) 검정을 사용. 이는 변수들이 서로 얼마나 강하게 연관되어 있는지를 측정하여, 너무 높은 상관관계를 보이는 변수들을 제거함으로써 모델의 독립성을 유지하고자 함.

2. 정상성 검정: 데이터의 정상성을 확인하기 위해 ADF(디키-풀러) 검정을 수행. 시계열 데이터가 정상적인지, 즉 시간에 따라 그 속성이 일정하게 유지되는지 확인하는 과정임. 정상성을 만족하지 않는 데이터는 차분, Box-Cox 변환, 로그 변환 등을 통해 정상 시계열로 변환.

3. 인과성 검정과 VAR 피처 선택: 마지막으로, Granger 인과성 검정과 VAR(벡터 자기회귀) 모델을 활용한 피처 선택을 통해 변수들 간의 인과 관계를 파악하고, 모델에 유용한 변수들만을 최종적으로 선택하였음. 이는 시간 지연을 고려하여 한 변수가 다른 변수의 미래 값을 예측하는데 유용한지를 평가하는 과정이었음.


위 과정을 통해서 데이터 내의 문제점들을 해결하기 위해 변수들 사이의 관계를 분석하고, 모델에 적합하지 않은 데이터를 걸러내기 위한 여러 단계의 검증 과정을 거침. 이 과정을 통해 모델의 정확성과 효율성을 높이기 위한 적절한 변수들만을 선정할 수 있었음.

  
  
  

## 결과

VAR은 RMSE가 73, MAPE는 0.038883

VARMAX는 RMSE가 127, MAPE는 0.06081

LSTM + CNN 모델은 RMSE가 95.577, MAPE는 0.04174

  

2020년5월~2023년4월 기간동안 이 지수에 추종할 수 있었다면 159%의 수익률이지만,

VAR모델, VARMAX모델, LSTM + CNN 모델에 따라 투자를 진행했었다면

각각 수익률이 230%, 236%, 183%.

  

실제로 정확한 값을 예측하는 것은 VAR > VARMAX > LSTM 모델 순서이지만,

투자성과가 좋은 모델은 VAR > LSTM > VARMAX 순서였음.
